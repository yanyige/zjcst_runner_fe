<view class="profile-page" wx:if="{{userInfo}}">
  <view class="section user-card">
    <view class="avatar" bindtap="handleChooseAvatar">
      <image wx:if="{{userInfo.avatarUrl}}" src="{{userInfo.avatarUrl}}" mode="aspectFill" />
      <view wx:else class="avatar-placeholder">{{placeholderInitial}}</view>
      <view class="change-tip">点击更换头像</view>
    </view>
    <view class="info">
      <view class="name">{{userInfo.name || '未设置姓名'}}</view>
      <view class="text-muted">学号：{{userInfo.student_id || '--'}}</view>
      <view class="text-muted">班级：{{userInfo.class_name || '--'}} | 年级：{{userInfo.grade || '--'}}</view>
    </view>
  </view>

  <view class="section total">
    <view class="section-title">累计里程</view>
    <view class="distance">{{totalDistance}} km</view>
  </view>

  <view class="section badges" wx:if="{{badges.length}}">
    <view class="section-title">成就徽章</view>
    <view class="badge-list">
      <block wx:for="{{badges}}" wx:key="label">
        <view class="badge-item">
          <view class="badge-name">🏆 {{item.label}}</view>
          <view class="text-muted">{{item.desc}}</view>
        </view>
      </block>
    </view>
  </view>

  <view class="section" wx:if="{{!badges.length}}">
    <view class="section-title">成就徽章</view>
    <view class="text-muted">继续努力，很快就能获得徽章！</view>
  </view>

  <button class="logout-btn" bindtap="handleLogout">退出登录</button>
</view>

<view wx:if="{{loading}}" class="loading-mask">
  <text>加载中...</text>
</view>
