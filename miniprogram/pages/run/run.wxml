<view class="run-page">
  <!-- 主界面 -->
  <view wx:if="{{showMain}}" class="main-interface">
    <view class="section stats">
      <view class="stat-item">
        <view class="label">总距离 (公里)</view>
        <view class="value">{{distance}}</view>
      </view>
      <view class="stat-item">
        <view class="label">用时</view>
        <view class="value">{{hours}}:{{minutes}}:{{secondes}}</view>
      </view>
      <view class="stat-item">
        <view class="label">当前速度</view>
        <view class="value">{{speed}}</view>
      </view>
    </view>

    <view class="section control">
      <button class="primary-btn" bindtap="startRun">开始跑步</button>
    </view>
  </view>

  <!-- 跑步界面 -->
  <view wx:if="{{!showMain && !showRes}}" class="running-interface">
    <view class="section stats">
      <view class="stat-item">
        <view class="label">总距离 (公里)</view>
        <view class="value">{{distance}}</view>
      </view>
      <view class="stat-item">
        <view class="label">用时</view>
        <view class="value">{{hours}}:{{minutes}}:{{secondes}}</view>
      </view>
      <view class="stat-item">
        <view class="label">当前速度</view>
        <view class="value">{{speed}}</view>
      </view>
    </view>

    <view class="section control">
      <button class="pause-btn" bindtap="pauseRun">{{pause}}</button>
      <button class="stop-btn" bindtap="stopRun">结束</button>
    </view>

    <!-- 轨迹地图 -->
    <view class="section map" wx:if="{{polyLine.length}}">
      <view class="section-title">跑步轨迹</view>
      <map 
        class="map-container"
        longitude="{{longitude}}" 
        latitude="{{latitude}}"
        scale="16"
        polyline="{{polyLine}}"
        show-location="true">
      </map>
    </view>
  </view>

  <!-- 结果界面 -->
  <view wx:if="{{showRes}}" class="result-interface">
    <view class="section stats">
      <view class="stat-item">
        <view class="label">总距离 (公里)</view>
        <view class="value">{{distance}}</view>
      </view>
      <view class="stat-item">
        <view class="label">用时</view>
        <view class="value">{{hours}}:{{minutes}}:{{secondes}}</view>
      </view>
      <view class="stat-item">
        <view class="label">平均速度</view>
        <view class="value">{{avrSpeed}}</view>
      </view>
    </view>

    <view class="section stats">
      <view class="stat-item">
        <view class="label">最高速度</view>
        <view class="value">{{maxSpeed}}</view>
      </view>
      <view class="stat-item">
        <view class="label">最低速度</view>
        <view class="value">{{minSpeed}}</view>
      </view>
      <view class="stat-item">
        <view class="label">消耗热量</view>
        <view class="value">{{heat}} 卡</view>
      </view>
    </view>

    <!-- 轨迹地图 -->
    <view class="section map" wx:if="{{polyLine.length}}">
      <view class="section-title">跑步轨迹</view>
      <map 
        class="map-container"
        longitude="{{longitude}}" 
        latitude="{{latitude}}"
        scale="16"
        polyline="{{polyLine}}"
        show-location="true">
      </map>
    </view>

    <view wx:if="{{allowUpload}}" class="tips">
      已满足 {{minValidDistance}} 公里有效打卡要求
    </view>

    <view class="section control">
      <button class="primary-btn" bindtap="initData">重新开始</button>
    </view>
  </view>

</view>